<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Meldi geht ein Licht auf â€“ Ein auÃŸerirdisch guter Film</title>
<link href="https://fonts.googleapis.com/css2?family=Bangers&family=DM+Sans:wght@400;500;600;700;800&display=swap" rel="stylesheet">
<style>
:root{--green:#689246;--blue:#1678A9;--beige:#FAEFD8;--red:#E04040;--yellow:#E5A700;--purple:#8B5CF6;--text:#3D3D3D;--comic:'Bangers',cursive;--body:'DM Sans',sans-serif}
*{margin:0;padding:0;box-sizing:border-box}
body{font-family:var(--body);background:#0a0a1a;display:flex;align-items:center;justify-content:center;height:100vh;height:100dvh;overflow:hidden}

.cinema{width:min(96vw,840px);aspect-ratio:16/9;background:#000;border-radius:14px;overflow:hidden;position:relative;box-shadow:0 20px 80px rgba(0,0,0,.6)}

/* Landscape mobile fix */
@media (orientation:landscape) and (max-height:500px){
  .cinema{width:100vw;height:100vh;border-radius:0;aspect-ratio:auto}
  .sub{padding:12px 16px 36px}
  .sub__text{font-size:clamp(10px,1.8vh,14px)}
  .speech{font-size:clamp(9px,1.5vh,12px);padding:6px 10px;max-width:200px}
  body{height:100vh;height:100dvh}
}

/* â”€â”€â”€ Scenes â”€â”€â”€ */
.scene{position:absolute;inset:0;opacity:0;transition:opacity .8s ease;display:flex;align-items:center;justify-content:center;pointer-events:none;overflow:hidden;will-change:opacity;transform:translateZ(0)}
.scene.active{opacity:1;pointer-events:auto}

/* â”€â”€â”€ Subtitle â”€â”€â”€ */
.sub{position:absolute;bottom:0;left:0;right:0;background:linear-gradient(transparent,rgba(0,0,0,.88));padding:28px 24px 46px;z-index:50}
.sub__text{color:#fff;font-size:clamp(12px,2vw,17px);font-weight:600;line-height:1.5;text-align:center;opacity:0;transform:translateY(10px);transition:opacity .5s ease .3s,transform .5s ease .3s;text-shadow:0 2px 8px rgba(0,0,0,.5)}
.scene.active .sub__text{opacity:1;transform:translateY(0)}

/* â”€â”€â”€ Speech Bubble â”€â”€â”€ */
.speech{
  position:absolute;z-index:40;
  background:#fff;border:2.5px solid var(--text);border-radius:18px;
  padding:clamp(8px,1.5vw,14px) clamp(12px,2vw,18px);
  font-size:clamp(10px,1.6vw,14px);font-weight:700;line-height:1.4;
  max-width:clamp(140px,30vw,260px);
  opacity:0;transform:scale(.7);
  transition:opacity .4s ease,transform .4s ease;
  box-shadow:3px 3px 0 rgba(0,0,0,.1);
}
.scene.active .speech{opacity:1;transform:scale(1)}
.speech::after{
  content:'';position:absolute;bottom:-10px;left:25px;
  width:0;height:0;border-left:10px solid transparent;border-right:10px solid transparent;border-top:10px solid var(--text);
}
.speech::before{
  content:'';position:absolute;bottom:-7px;left:27px;
  width:0;height:0;border-left:8px solid transparent;border-right:8px solid transparent;border-top:8px solid #fff;z-index:1;
}
.speech--alien{background:#E8F0FF;border-color:var(--purple)}
.speech--alien::after{border-top-color:var(--purple)}
.speech--alien::before{border-top-color:#E8F0FF}
.speech--red{background:#FFF0F0;border-color:var(--red)}
.speech--red::after{border-top-color:var(--red)}
.speech--red::before{border-top-color:#FFF0F0}
.speech--green{background:#EEFBF0;border-color:var(--green)}
.speech--green::after{border-top-color:var(--green)}
.speech--green::before{border-top-color:#EEFBF0}

.speech--top::after{bottom:auto;top:-10px;border-top:none;border-bottom:10px solid var(--text)}
.speech--top::before{bottom:auto;top:-7px;border-top:none;border-bottom:8px solid #fff}
.speech--alien.speech--top::after{border-bottom-color:var(--purple)}
.speech--alien.speech--top::before{border-bottom-color:#E8F0FF}

/* delay classes */
.d1{transition-delay:.5s!important}
.d2{transition-delay:.9s!important}
.d3{transition-delay:1.3s!important}
.d4{transition-delay:1.7s!important}
.d5{transition-delay:2.1s!important}

/* â•â•â• MELDI CHARACTER â•â•â• */
.alien{position:relative;display:inline-block;transform:translateZ(0)}
/* Head - round, separate from body */
.alien__head{
  width:clamp(32px,6.5vw,54px);height:clamp(30px,6vw,50px);
  background:linear-gradient(180deg,#7CDB7C,#4CAF50);
  border-radius:50%;position:absolute;
  top:0;left:50%;transform:translateX(-50%);
  z-index:2;border:2px solid #3a9a3a;
}
/* Body - smaller torso with T-shirt */
.alien__body{
  width:clamp(28px,5.5vw,46px);height:clamp(26px,5vw,42px);
  background:linear-gradient(180deg,var(--blue),#0F5C84);
  border-radius:8px 8px 6px 6px;position:relative;
  margin-top:clamp(26px,5.2vw,44px);
  margin-left:auto;margin-right:auto;
  border:1.5px solid #0a4a6e;
}
/* Veloxaner-Wappen on shirt */
.alien__body::after{
  content:'';position:absolute;top:40%;left:50%;transform:translate(-50%,-50%);
  width:clamp(10px,2vw,16px);height:clamp(10px,2vw,16px);
  background:radial-gradient(circle at 40% 35%,#2E7D32,#1B5E20);
  border-radius:50% 50% 50% 50% / 40% 40% 60% 60%;
  border:1px solid rgba(255,255,255,.35);
  box-shadow:0 0 4px rgba(76,175,80,.3);
}
/* Gold star on the crest */
.alien__body::before{
  content:'â˜…';position:absolute;top:34%;left:50%;transform:translate(-50%,-50%);
  font-size:clamp(5px,1vw,7px);color:#FFD93D;z-index:1;
  text-shadow:0 0 3px rgba(255,217,61,.5);line-height:1;
}
/* Big expressive eyes */
.alien__eye{
  position:absolute;top:25%;width:clamp(11px,2.2vw,18px);height:clamp(13px,2.6vw,22px);
  background:#fff;border-radius:50%;
  display:flex;align-items:center;justify-content:center;
  border:1.5px solid #2a7a2a;
}
.alien__eye--l{left:12%}.alien__eye--r{right:12%}
.alien__pupil{
  width:50%;height:50%;background:#222;border-radius:50%;
  position:relative;
  animation:look 3s ease-in-out infinite;
}
/* Pupil highlight */
.alien__pupil::after{
  content:'';position:absolute;top:1px;right:1px;
  width:35%;height:35%;background:#fff;border-radius:50%;
}
@keyframes look{0%,100%{transform:translateX(0)}30%{transform:translateX(2px)}70%{transform:translateX(-2px)}}
/* Happy smile */
.alien__mouth{
  position:absolute;bottom:18%;left:50%;transform:translateX(-50%);
  width:clamp(12px,2.4vw,20px);height:clamp(6px,1.2vw,10px);
  border-bottom:clamp(2px,.4vw,3px) solid #2E7D32;
  border-radius:0 0 50% 50%;
  background:transparent;
}
/* Antenna with glowing tip */
.alien__antenna{
  position:absolute;top:calc(-1 * clamp(14px,2.8vw,24px));left:50%;transform:translateX(-50%);
  width:2px;height:clamp(12px,2.4vw,20px);background:#4CAF50;
  z-index:3;
}
.alien__antenna::after{
  content:'';position:absolute;top:calc(-1 * clamp(5px,1vw,8px));left:50%;transform:translateX(-50%);
  width:clamp(7px,1.4vw,12px);height:clamp(7px,1.4vw,12px);
  background:#FFD93D;border-radius:50%;
  animation:glow 1.5s ease-in-out infinite;
}
@keyframes glow{0%,100%{box-shadow:0 0 4px #FFD93D}50%{box-shadow:0 0 14px #FFD93D,0 0 24px rgba(255,217,61,.4)}}
/* Arms - longer, more expressive */
.alien__arm{
  position:absolute;top:clamp(30px,6vw,50px);
  width:clamp(14px,2.8vw,24px);height:clamp(5px,1vw,8px);
  background:#4CAF50;border-radius:4px;border:1px solid #3a9a3a;
}
.alien__arm--l{left:calc(-1 * clamp(12px,2.4vw,20px));transform:rotate(-20deg);transform-origin:right center}
.alien__arm--r{right:calc(-1 * clamp(12px,2.4vw,20px));transform:rotate(20deg);transform-origin:left center}
/* 3-finger hands */
.alien__hand{
  position:absolute;top:clamp(28px,5.6vw,47px);
  width:clamp(8px,1.6vw,14px);height:clamp(8px,1.6vw,14px);
  background:#7CDB7C;border-radius:50%;border:1px solid #3a9a3a;
}
.alien__hand--l{left:calc(-1 * clamp(16px,3.2vw,28px))}
.alien__hand--r{right:calc(-1 * clamp(16px,3.2vw,28px))}
/* Legs with sneakers */
.alien__leg{
  position:absolute;bottom:calc(-1 * clamp(14px,2.8vw,24px));
  width:clamp(7px,1.4vw,12px);height:clamp(12px,2.4vw,20px);
  background:#4CAF50;border-radius:0 0 3px 3px;border:1px solid #3a9a3a;
}
.alien__leg--l{left:18%}.alien__leg--r{right:18%}
.alien__shoe{
  position:absolute;bottom:calc(-1 * clamp(20px,4vw,34px));
  width:clamp(11px,2.2vw,18px);height:clamp(6px,1.2vw,10px);
  background:#FF5252;border-radius:3px 6px 3px 3px;border:1px solid #c33;
}
.alien__shoe--l{left:14%}.alien__shoe--r{right:14%}

/* â”€â”€ Meldi on bike â”€â”€ */
.alien-bike{position:relative;display:inline-block}
.alien-bike .alien{position:absolute;bottom:clamp(22px,4.4vw,38px);left:50%;transform:translateX(-50%)}
.alien-bike__wheels{display:flex;gap:clamp(20px,4vw,34px)}
.alien-bike__wh{
  width:clamp(22px,4.4vw,36px);height:clamp(22px,4.4vw,36px);
  border:clamp(2px,.4vw,3px) solid #444;border-radius:50%;
  animation:spin .6s linear infinite;position:relative;
  background:rgba(255,255,255,.1);
}
.alien-bike__wh::after{content:'';position:absolute;inset:30%;background:#444;border-radius:50%}
/* Spokes */
.alien-bike__wh::before{
  content:'';position:absolute;top:50%;left:50%;
  width:1px;height:80%;background:#666;transform:translate(-50%,-50%);
}
@keyframes spin{to{transform:rotate(360deg)}}
.alien-bike__frame{
  position:absolute;bottom:clamp(14px,2.8vw,24px);left:50%;transform:translateX(-50%);
  width:clamp(26px,5.2vw,44px);height:clamp(3px,.6vw,4px);background:var(--green);
  border-radius:2px;
}
/* Handlebars */
.alien-bike__bar{
  position:absolute;bottom:clamp(20px,4vw,34px);right:-3px;
  width:clamp(3px,.6vw,5px);height:clamp(10px,2vw,18px);
  background:#888;border-radius:2px;
}

/* â”€â”€ Meldi states â”€â”€ */
.alien--excited{animation:bounce .5s ease-in-out infinite}
@keyframes bounce{0%,100%{transform:translateY(0)}50%{transform:translateY(-8px)}}
/* Shocked - big O mouth, wide eyes */
.alien--shocked .alien__mouth{
  width:clamp(10px,2vw,16px)!important;height:clamp(10px,2vw,16px)!important;
  border:none!important;background:#2E7D32;border-radius:50%!important;
  bottom:15%!important;
}
.alien--shocked .alien__eye{transform:scale(1.2)}
/* Happy - wave arm, big smile */
.alien--happy .alien__arm--r{animation:wave .4s ease-in-out infinite}
.alien--happy .alien__hand--r{animation:wave .4s ease-in-out infinite}
@keyframes wave{0%,100%{transform:rotate(20deg)}50%{transform:rotate(-50deg)}}

/* â•â•â• UFO (Fahrrad-Raumschiff) â•â•â• */
.ufo{
  position:relative;display:inline-block;
  width:clamp(80px,16vw,130px);height:clamp(50px,10vw,85px);
}
/* â”€â”€ Main saucer body â”€â”€ */
.ufo__disc{
  position:absolute;bottom:20%;left:50%;transform:translateX(-50%);
  width:100%;height:clamp(18px,3.6vw,30px);
  background:linear-gradient(180deg,#CFD8DC,#90A4AE 40%,#78909C);
  border-radius:50%;
  border-top:1px solid rgba(255,255,255,.4);
  box-shadow:
    0 4px 12px rgba(0,0,0,.2),
    0 0 20px rgba(100,200,255,.15),
    inset 0 2px 4px rgba(255,255,255,.3);
}
/* Top dome - glass cockpit */
.ufo__dome{
  position:absolute;bottom:42%;left:50%;transform:translateX(-50%);
  width:clamp(30px,6vw,50px);height:clamp(20px,4vw,34px);
  background:linear-gradient(180deg,rgba(130,210,255,.55),rgba(100,200,255,.15));
  border-radius:50% 50% 30% 30%;
  border:1.5px solid rgba(255,255,255,.35);
  box-shadow:0 0 14px rgba(100,200,255,.25);
  z-index:3;
}
/* Bike on dome removed â€“ replaced by Veloxaner crest */
/* Saucer body (structural) */
.ufo__body{
  position:absolute;inset:0;
}
/* Ring of lights around disc edge */
.ufo__dots{
  position:absolute;bottom:22%;left:50%;transform:translateX(-50%);
  display:flex;gap:clamp(8px,1.6vw,14px);z-index:3;
}
.ufo__dot{
  width:clamp(5px,1vw,8px);height:clamp(5px,1vw,8px);border-radius:50%;
  animation:ufo-blink .8s ease-in-out infinite alternate;
  box-shadow:0 0 4px currentColor;
}
.ufo__dot:nth-child(1){background:#FF5252;color:#FF5252;animation-delay:0s}
.ufo__dot:nth-child(2){background:#FFD93D;color:#FFD93D;animation-delay:.2s}
.ufo__dot:nth-child(3){background:#4CAF50;color:#4CAF50;animation-delay:.4s}
.ufo__dot:nth-child(4){background:#42A5F5;color:#42A5F5;animation-delay:.6s}
@keyframes ufo-blink{0%{opacity:.3;transform:scale(.8)}100%{opacity:1;transform:scale(1)}}
/* Engine glow underneath */
.ufo__light{
  position:absolute;bottom:0;left:50%;transform:translateX(-50%);
  width:60%;height:clamp(6px,1.2vw,10px);
  background:radial-gradient(ellipse,rgba(100,200,255,.35),transparent 70%);
  border-radius:50%;
  animation:thruster 1s ease-in-out infinite alternate;
}
@keyframes thruster{0%{opacity:.3;transform:translateX(-50%) scaleX(.7)}100%{opacity:.9;transform:translateX(-50%) scaleX(1.2)}}
/* Bottom rim accent */
.ufo__rim{
  position:absolute;bottom:18%;left:50%;transform:translateX(-50%);
  width:85%;height:clamp(3px,.6vw,5px);
  background:linear-gradient(90deg,transparent,rgba(255,255,255,.2),transparent);
  border-radius:50%;
}
/* â”€â”€ Veloxaner-Wappen (Fahrrad-Emblem auf der Untertasse) â”€â”€ */
.ufo__crest{
  position:absolute;bottom:24%;left:50%;transform:translateX(-50%);
  width:clamp(22px,4.4vw,36px);height:clamp(22px,4.4vw,36px);
  z-index:5;
}
/* Shield background */
.ufo__crest-shield{
  position:absolute;inset:0;
  background:radial-gradient(circle at 40% 35%,#2E7D32,#1B5E20);
  border-radius:50% 50% 50% 50% / 40% 40% 60% 60%;
  border:1.5px solid rgba(255,255,255,.35);
  box-shadow:0 0 8px rgba(76,175,80,.3),inset 0 1px 2px rgba(255,255,255,.2);
}
/* Bike wheel left */
.ufo__crest-wh1{
  position:absolute;bottom:22%;left:14%;
  width:clamp(7px,1.4vw,11px);height:clamp(7px,1.4vw,11px);
  border:1.5px solid #FFD93D;border-radius:50%;
  box-shadow:0 0 3px rgba(255,217,61,.4);
}
.ufo__crest-wh1::after{
  content:'';position:absolute;inset:25%;background:#FFD93D;border-radius:50%;
}
/* Bike wheel right */
.ufo__crest-wh2{
  position:absolute;bottom:22%;right:14%;
  width:clamp(7px,1.4vw,11px);height:clamp(7px,1.4vw,11px);
  border:1.5px solid #FFD93D;border-radius:50%;
  box-shadow:0 0 3px rgba(255,217,61,.4);
}
.ufo__crest-wh2::after{
  content:'';position:absolute;inset:25%;background:#FFD93D;border-radius:50%;
}
/* Bike frame triangle */
.ufo__crest-frame{
  position:absolute;bottom:32%;left:50%;transform:translateX(-50%);
  width:0;height:0;
  border-left:clamp(5px,1vw,8px) solid transparent;
  border-right:clamp(5px,1vw,8px) solid transparent;
  border-bottom:clamp(6px,1.2vw,10px) solid #FFD93D;
  filter:drop-shadow(0 0 2px rgba(255,217,61,.4));
}
/* Star above bike (Veloxaner symbol) */
.ufo__crest-star{
  position:absolute;top:12%;left:50%;transform:translateX(-50%);
  font-size:clamp(5px,1vw,8px);
  color:#FFD93D;
  text-shadow:0 0 4px rgba(255,217,61,.5);
  line-height:1;
}
/* AnhÃ¤ngerkupplung (clean, below saucer) */
.ufo__hitch{
  position:absolute;right:8%;bottom:16%;z-index:3;
}
.ufo__hitch-bar{
  width:clamp(8px,1.6vw,12px);height:clamp(2px,.4vw,3px);
  background:linear-gradient(90deg,#90A4AE,#B0BEC5);
  border-radius:1px;
}
.ufo__hitch-ball{
  position:absolute;right:calc(-1 * clamp(3px,.6vw,5px));top:50%;
  transform:translateY(-50%);
  width:clamp(5px,1vw,7px);height:clamp(5px,1vw,7px);
  background:radial-gradient(circle at 35% 35%,#E0E0E0,#78909C);
  border-radius:50%;border:1px solid rgba(0,0,0,.12);
  box-shadow:0 0 3px rgba(100,200,255,.2);
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   SCENE 0: Title - Space
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.s0-bg{position:absolute;inset:0;background:radial-gradient(ellipse at 50% 50%,#0a0a2e 0%,#050510 100%)}
.s0-stars{position:absolute;inset:0}
.star{position:absolute;background:#fff;border-radius:50%;animation:twinkle 2s ease-in-out infinite}
@keyframes twinkle{0%,100%{opacity:.2;transform:scale(.8)}50%{opacity:1;transform:scale(1.2)}}

.s0-content{text-align:center;z-index:2;position:relative}
.s0-logbook{
  font-family:var(--body);font-size:clamp(9px,1.5vw,13px);
  color:rgba(100,200,255,.6);letter-spacing:1.5px;text-transform:uppercase;
  margin-bottom:10px;
  opacity:0;transform:translateY(-8px);transition:opacity .5s ease .1s,transform .5s ease .1s;
  text-shadow:0 0 8px rgba(100,200,255,.3);
}
.scene.active .s0-logbook{opacity:1;transform:translateY(0)}
.s0-logo{
  font-family:var(--comic);font-size:clamp(28px,5.5vw,48px);
  letter-spacing:2px;margin-bottom:2px;
  opacity:0;transform:scale(.7);transition:opacity .6s ease .3s,transform .6s ease .3s;
}
.scene.active .s0-logo{opacity:1;transform:scale(1)}
.s0-logo .gr{color:var(--green)}.s0-logo .bl{color:#5BB8F0}
.s0-tagline{
  font-family:var(--comic);font-size:clamp(14px,2.8vw,24px);
  color:var(--purple);letter-spacing:1px;
  opacity:0;transition:opacity .5s ease .7s;
}
.scene.active .s0-tagline{opacity:1}
.s0-subtitle{
  color:rgba(255,255,255,.4);font-size:clamp(10px,1.6vw,14px);
  margin-top:8px;opacity:0;transition:opacity .5s ease 1s;
}
.scene.active .s0-subtitle{opacity:1}

.s0-ufo{
  position:absolute;top:20%;right:10%;
  opacity:0;transform:translate(60px,-30px);
  transition:opacity .6s ease .5s,transform 1s ease .5s;
}
.scene.active .s0-ufo{opacity:1;transform:translate(0,0)}
.s0-ufo .ufo{animation:hover 3s ease-in-out infinite}
@keyframes hover{0%,100%{transform:translateY(0) rotate(-2deg)}50%{transform:translateY(-10px) rotate(2deg)}}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   SCENE 1: Landing in Saarland
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.s1-bg{
  position:absolute;inset:0;
  background:linear-gradient(180deg,#0d0d2b 0%,#1a1a4e 25%,#2a3a5e 42%,#4a7a3a 52%,#3d6e30 60%,#3a6a2e 100%);
}
/* Stars in night sky */
.s1-stars{position:absolute;inset:0;overflow:hidden}
.s1-star{
  position:absolute;background:#fff;border-radius:50%;
  animation:twinkle 2s ease-in-out infinite alternate;
}
@keyframes twinkle{0%{opacity:.3}100%{opacity:1}}
.s1-moon{
  position:absolute;top:6%;right:14%;
  width:clamp(24px,5vw,42px);height:clamp(24px,5vw,42px);
  background:linear-gradient(135deg,#FFF8E1,#FFE082);border-radius:50%;
  box-shadow:0 0 30px rgba(255,224,130,.5),0 0 60px rgba(255,224,130,.2);
}
/* Rolling hills silhouette */
.s1-hills{
  position:absolute;bottom:0;left:0;right:0;height:55%;
  background:
    radial-gradient(ellipse 70% 40% at 20% 80%, #3d6e30 70%, transparent 70%),
    radial-gradient(ellipse 60% 35% at 55% 85%, #4a7a3a 70%, transparent 70%),
    radial-gradient(ellipse 80% 45% at 85% 78%, #3a6a2e 70%, transparent 70%);
}
/* Simple tree silhouettes */
.s1-tree{position:absolute;bottom:38%}
.s1-tree::before{
  content:'';display:block;
  width:0;height:0;
  border-left:clamp(8px,1.6vw,14px) solid transparent;
  border-right:clamp(8px,1.6vw,14px) solid transparent;
  border-bottom:clamp(18px,3.6vw,32px) solid #2d5a22;
}
.s1-tree::after{
  content:'';display:block;
  width:clamp(3px,.6vw,5px);height:clamp(6px,1.2vw,10px);
  background:#4a3520;margin:0 auto;
}
.s1-tree--1{left:8%}.s1-tree--2{left:18%;bottom:40%}.s1-tree--3{right:22%;bottom:36%}
.s1-tree--4{right:6%;bottom:42%}.s1-tree--5{left:72%;bottom:39%}

.s1-ufo{
  position:absolute;top:12%;left:38%;
  opacity:0;
  animation:land 2.2s ease-in-out .3s forwards;
}
@keyframes land{
  0%{transform:translate(-80px,-50px) scale(.4);opacity:0}
  35%{opacity:1}
  100%{transform:translate(0,0) scale(1);opacity:1}
}
.s1-ufo .ufo{animation:hover 2s ease-in-out infinite}
/* Brighter, wider beam */
.s1-beam{
  position:absolute;top:38%;left:42%;
  width:0;height:0;
  border-left:clamp(24px,5vw,42px) solid transparent;
  border-right:clamp(24px,5vw,42px) solid transparent;
  border-top:clamp(60px,12vw,100px) solid rgba(255,255,100,.12);
  filter:blur(2px);
  opacity:0;transition:opacity .5s ease .8s;
}
.scene.active .s1-beam{opacity:1}
/* Beam glow ring on ground */
.s1-beamring{
  position:absolute;bottom:30%;left:39%;
  width:clamp(40px,8vw,70px);height:clamp(10px,2vw,18px);
  border-radius:50%;
  background:radial-gradient(ellipse,rgba(255,255,100,.2),transparent 70%);
  opacity:0;transition:opacity .4s ease 1.2s;
}
.scene.active .s1-beamring{opacity:1}

.s1-alien{
  position:absolute;bottom:26%;left:44%;
  opacity:0;transform:translateY(-30px);
  transition:opacity .3s ease 1.4s,transform .5s ease 1.4s;
}
.scene.active .s1-alien{opacity:1;transform:translateY(0)}

/* Proper German road sign style */
.s1-sign{
  position:absolute;bottom:26%;right:10%;
  opacity:0;transition:opacity .4s ease .5s;
}
.scene.active .s1-sign{opacity:1}
.s1-sign__post{
  width:clamp(3px,.5vw,4px);height:clamp(30px,6vw,50px);
  background:#888;margin:0 auto;
}
.s1-sign__plate{
  background:linear-gradient(135deg,#FFD700,#FFC107);
  border:clamp(2px,.3vw,3px) solid #333;border-radius:3px;
  padding:clamp(4px,.8vw,7px) clamp(8px,1.6vw,14px);
  font-size:clamp(7px,1.3vw,11px);font-weight:800;color:#333;
  text-align:center;white-space:nowrap;
  box-shadow:0 2px 8px rgba(0,0,0,.2);
  transform:rotate(-2deg);
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   SCENE 2: Cycling chaos
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.s2-bg{
  position:absolute;inset:0;
  background:linear-gradient(180deg,#6CB4EE 0%,#9DD1F5 32%,#78A856 32%,#6B9A4A 40%,#777 40%,#666 100%);
}
.s2-alien-bike{
  position:absolute;bottom:34%;left:15%;
  opacity:0;transform:translateX(-50px);
  transition:opacity .5s ease .3s,transform .8s ease .3s;
}
.scene.active .s2-alien-bike{opacity:1;transform:translateX(0)}
.s2-alien-bike .alien--shocked{animation:bike-shake .3s ease-in-out infinite}
@keyframes bike-shake{0%,100%{transform:translateX(-50%) rotate(-3deg)}50%{transform:translateX(-50%) rotate(3deg)}}

.s2-obstacles{position:absolute;inset:0}
.s2-hole{
  position:absolute;bottom:28%;
  width:clamp(34px,7vw,58px);height:clamp(10px,2vw,16px);
  background:#333;border-radius:50%;border:2px solid #222;
  box-shadow:inset 0 2px 4px rgba(0,0,0,.5);
}
.s2-hole--1{left:42%}
.s2-hole--2{left:68%}
/* Big CSS car blocking the road */
.s2-car{
  position:absolute;bottom:29%;right:5%;
  width:clamp(60px,12vw,100px);height:clamp(30px,6vw,50px);
  background:linear-gradient(180deg,#c0392b,#a93226);
  border-radius:8px 8px 4px 4px;
  opacity:0;transition:opacity .4s ease .8s;
  border:1.5px solid #8e2420;
  transform:translateZ(0);
}
.scene.active .s2-car{opacity:1}
.s2-car::before{
  content:'';position:absolute;top:-35%;left:15%;right:15%;height:50%;
  background:linear-gradient(180deg,#85c1e9,#aed6f1);
  border-radius:6px 6px 0 0;border:1.5px solid #7fb3d3;
}
.s2-car::after{
  content:'';position:absolute;bottom:-20%;left:12%;
  width:clamp(10px,2vw,16px);height:clamp(10px,2vw,16px);
  background:#333;border-radius:50%;border:2px solid #555;
  box-shadow:clamp(28px,5.6vw,48px) 0 0 0 #333;
}
/* Parked car on bike lane */
.s2-parkcar{
  position:absolute;bottom:31%;right:28%;
  width:clamp(50px,10vw,84px);height:clamp(26px,5.2vw,44px);
  background:linear-gradient(180deg,#5b5b5b,#444);
  border-radius:6px 6px 3px 3px;
  opacity:0;transition:opacity .4s ease 1s;
  border:1.5px solid #333;
}
.scene.active .s2-parkcar{opacity:1}
.s2-parkcar::before{
  content:'';position:absolute;top:-30%;left:18%;right:18%;height:45%;
  background:linear-gradient(180deg,#85c1e9,#aed6f1);
  border-radius:5px 5px 0 0;border:1px solid #7fb3d3;
}
.s2-parkcar::after{
  content:'';position:absolute;bottom:-18%;left:10%;
  width:clamp(8px,1.6vw,14px);height:clamp(8px,1.6vw,14px);
  background:#333;border-radius:50%;border:1.5px solid #555;
  box-shadow:clamp(22px,4.4vw,38px) 0 0 0 #333;
}
/* P-sign on parked car */
.s2-psign{
  position:absolute;bottom:42%;right:30%;
  background:var(--blue);color:#fff;
  width:clamp(14px,2.8vw,22px);height:clamp(14px,2.8vw,22px);
  border-radius:3px;display:flex;align-items:center;justify-content:center;
  font-size:clamp(8px,1.6vw,14px);font-weight:800;
  opacity:0;transition:opacity .3s ease 1.2s;z-index:5;
}
.scene.active .s2-psign{opacity:1}
.s2-crack{
  position:absolute;bottom:30%;left:46%;
  font-size:clamp(18px,3.6vw,32px);
  animation:shake .3s ease-in-out infinite;
  opacity:0;transition:opacity .3s ease .6s;
}
.scene.active .s2-crack{opacity:1}
@keyframes shake{0%,100%{transform:rotate(-8deg)}50%{transform:rotate(8deg)}}

.s2-effects{position:absolute;top:10%;right:5%;display:flex;flex-direction:column;gap:8px}
.s2-fx{
  font-family:var(--comic);font-size:clamp(14px,2.8vw,24px);
  color:var(--red);
  opacity:0;transition:opacity .3s ease;
}
.scene.active .s2-fx:nth-child(1){opacity:1;transition-delay:.7s}
.scene.active .s2-fx:nth-child(2){opacity:1;transition-delay:1.1s}
.scene.active .s2-fx:nth-child(3){opacity:1;transition-delay:1.5s}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   SCENE 3: Discovers app
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.s3-bg{position:absolute;inset:0;background:radial-gradient(ellipse at 40% 50%,#1a3a2a,#0a2018)}
.s3-alien{
  position:absolute;left:12%;bottom:20%;
  opacity:0;transition:opacity .4s ease .2s;
}
.scene.active .s3-alien{opacity:1}
.s3-phone{
  position:absolute;left:50%;top:50%;transform:translate(-50%,-50%);
  width:clamp(90px,16vw,140px);height:clamp(170px,30vw,260px);
  background:#111;border-radius:clamp(10px,2vw,18px);padding:clamp(4px,.7vw,6px);
  box-shadow:0 0 40px rgba(104,146,70,.3),0 10px 40px rgba(0,0,0,.4);
  opacity:0;transform:translate(-50%,-50%) scale(.7);
  transition:opacity .5s ease .4s,transform .6s ease .4s;
}
.scene.active .s3-phone{opacity:1;transform:translate(-50%,-50%) scale(1)}
.s3-screen{width:100%;height:100%;background:#fff;border-radius:clamp(7px,1.4vw,14px);overflow:hidden;display:flex;flex-direction:column}
.s3-hdr{background:var(--blue);color:#fff;padding:clamp(3px,.6vw,6px);text-align:center;font-size:clamp(6px,1.1vw,9px);font-weight:800;letter-spacing:1px}
.s3-hdr span{color:#7BC67E}
.s3-items{padding:clamp(3px,.6vw,6px);display:flex;flex-direction:column;gap:clamp(2px,.4vw,4px)}
.s3-item{
  display:flex;align-items:center;gap:clamp(2px,.4vw,4px);
  padding:clamp(3px,.6vw,6px) clamp(4px,.8vw,8px);
  border-radius:clamp(3px,.6vw,6px);
  font-size:clamp(5px,1vw,8px);font-weight:700;
  opacity:0;transform:translateX(-8px);transition:opacity .3s ease,transform .3s ease;
}
.scene.active .s3-item:nth-child(1){opacity:1;transform:translateX(0);transition-delay:.7s}
.scene.active .s3-item:nth-child(2){opacity:1;transform:translateX(0);transition-delay:.9s}
.scene.active .s3-item:nth-child(3){opacity:1;transform:translateX(0);transition-delay:1.1s}
.s3-item--r{background:#FFF0F0;border-left:2px solid var(--red);color:var(--red)}
.s3-item--y{background:#FFF8E0;border-left:2px solid var(--yellow);color:#B8860B}
.s3-item--g{background:#EEFBF0;border-left:2px solid var(--green);color:var(--green)}
.s3-map{flex:1;background:#E8F0E8;margin:clamp(2px,.4vw,4px);border-radius:clamp(2px,.4vw,4px);position:relative}
.s3-pin{position:absolute;top:35%;left:40%;font-size:clamp(8px,1.6vw,12px);opacity:0;transition:opacity .3s ease 1.3s}
.scene.active .s3-pin{opacity:1}
.s3-ring{position:absolute;top:42%;left:45%;width:clamp(10px,2vw,16px);height:clamp(10px,2vw,16px);border:1.5px solid var(--blue);border-radius:50%;opacity:0;transition:opacity .2s ease 1.4s;animation:gps 1.5s ease-in-out infinite}
.scene.active .s3-ring{opacity:1}
@keyframes gps{0%{transform:translate(-50%,-50%) scale(.5);opacity:1}100%{transform:translate(-50%,-50%) scale(2.5);opacity:0}}

.s3-lightbulb{
  position:absolute;top:10%;left:20%;
  font-size:clamp(24px,5vw,44px);
  opacity:0;transition:opacity .3s ease 1.5s;
  animation:idea-pop 1s ease-in-out infinite;
}
.scene.active .s3-lightbulb{opacity:1}
@keyframes idea-pop{0%,100%{transform:scale(1) rotate(-5deg)}50%{transform:scale(1.15) rotate(5deg)}}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   SCENE 4: Reporting frenzy
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.s4-bg{position:absolute;inset:0;background:linear-gradient(180deg,#87CEEB 0%,#B8E0F0 35%,#78A856 35%,#6B9A4A 42%,#777 42%,#666 100%)}
.s4-alien{
  position:absolute;bottom:36%;left:22%;
  opacity:0;transition:opacity .3s ease .2s;
}
.scene.active .s4-alien{opacity:1}

.s4-pings{position:absolute;inset:0}
.s4-ping{
  position:absolute;font-size:clamp(14px,2.8vw,24px);
  opacity:0;transform:scale(0);
  transition:opacity .3s ease,transform .4s cubic-bezier(.17,.67,.28,1.5);
}
.scene.active .s4-ping:nth-child(1){opacity:1;transform:scale(1);transition-delay:.6s}
.scene.active .s4-ping:nth-child(2){opacity:1;transform:scale(1);transition-delay:1s}
.scene.active .s4-ping:nth-child(3){opacity:1;transform:scale(1);transition-delay:1.4s}
.scene.active .s4-ping:nth-child(4){opacity:1;transform:scale(1);transition-delay:1.8s}
.scene.active .s4-ping:nth-child(5){opacity:1;transform:scale(1);transition-delay:2.2s}

.s4-counter{
  position:absolute;top:8%;right:8%;
  background:var(--red);color:#fff;
  width:clamp(36px,7vw,60px);height:clamp(36px,7vw,60px);
  border-radius:50%;display:flex;align-items:center;justify-content:center;
  font-family:var(--comic);font-size:clamp(16px,3.2vw,28px);
  box-shadow:0 4px 15px rgba(224,64,64,.4);
}
.s4-counter__num{animation:count-up .3s ease}
@keyframes count-up{from{transform:scale(1.4)}to{transform:scale(1)}}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   SCENE 5: Municipality dashboard
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.s5-bg{position:absolute;inset:0;background:linear-gradient(135deg,#1a2a3a,#0a1a2a)}
.s5-dash{
  width:clamp(200px,40vw,340px);background:#fff;border-radius:10px;
  box-shadow:0 8px 40px rgba(0,0,0,.3);overflow:hidden;z-index:2;
  opacity:0;transform:translateY(20px);transition:opacity .5s ease .2s,transform .6s ease .2s;
}
.scene.active .s5-dash{opacity:1;transform:translateY(0)}
.s5-dhdr{background:var(--blue);color:#fff;padding:clamp(5px,1vw,8px) clamp(8px,1.4vw,12px);display:flex;justify-content:space-between;font-size:clamp(7px,1.3vw,11px);font-weight:700}
.s5-stats{display:flex;padding:clamp(5px,1vw,8px);gap:clamp(3px,.6vw,5px)}
.s5-stat{flex:1;text-align:center;padding:clamp(3px,.6vw,5px);background:#F8FAFC;border-radius:5px}
.s5-stat__n{font-size:clamp(12px,2.4vw,20px);font-weight:800}
.s5-stat__l{font-size:clamp(5px,.9vw,7px);color:#999;text-transform:uppercase}
.s5-map{height:clamp(40px,8vw,70px);background:#E8F0E8;margin:0 clamp(5px,1vw,8px) clamp(5px,1vw,8px);border-radius:4px;position:relative}
.s5-pin{position:absolute;font-size:clamp(6px,1.2vw,10px);opacity:0;transition:opacity .3s ease}
.scene.active .s5-pin:nth-child(1){opacity:1;transition-delay:.6s}
.scene.active .s5-pin:nth-child(2){opacity:1;transition-delay:.8s}
.scene.active .s5-pin:nth-child(3){opacity:1;transition-delay:1s}
.scene.active .s5-pin:nth-child(4){opacity:1;transition-delay:1.2s}
.scene.active .s5-pin:nth-child(5){opacity:1;transition-delay:1.4s}
.scene.active .s5-pin:nth-child(6){opacity:1;transition-delay:1.6s}

.s5-people{
  position:absolute;bottom:clamp(20px,5vw,50px);right:clamp(15px,4vw,40px);
  font-size:clamp(18px,3.6vw,32px);z-index:1;
  opacity:0;transition:opacity .4s ease 1.2s;
}
.scene.active .s5-people{opacity:.7}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   SCENE 6: Happy ending
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.s6-bg{position:absolute;inset:0;background:linear-gradient(180deg,#6CB4EE 0%,#9DD1F5 30%,#78A856 30%,#6B9A4A 40%,#999 40%,#888 100%)}
.s6-sun{position:absolute;top:4%;left:6%;width:clamp(28px,5.5vw,48px);height:clamp(28px,5.5vw,48px);background:#FFD93D;border-radius:50%;box-shadow:0 0 40px rgba(255,217,61,.5)}
.s6-path{
  position:absolute;bottom:30%;left:8%;right:8%;height:clamp(8px,1.6vw,14px);
  background:var(--green);border-radius:10px;
  transform:scaleX(0);transition:transform .8s ease .3s;transform-origin:left;
}
.scene.active .s6-path{transform:scaleX(1)}
.s6-path__label{
  position:absolute;top:calc(-1 * clamp(16px,3vw,26px));left:50%;transform:translateX(-50%);
  background:var(--green);color:#fff;padding:clamp(2px,.3vw,3px) clamp(6px,1vw,10px);
  border-radius:8px;font-size:clamp(6px,1.1vw,10px);font-weight:700;white-space:nowrap;
}
.s6-alien-bike{
  position:absolute;bottom:34%;
  opacity:0;animation:ride-across 2s ease .8s forwards;
}
@keyframes ride-across{0%{left:-10%;opacity:0}20%{opacity:1}100%{left:60%;opacity:1}}
.s6-confetti{position:absolute;font-size:clamp(12px,2.2vw,18px);animation:confetti 2.5s ease-in-out infinite}
@keyframes confetti{0%{transform:translateY(0) rotate(0);opacity:1}100%{transform:translateY(80px) rotate(360deg);opacity:0}}
.s6-confetti:nth-child(1){top:3%;left:10%;animation-delay:0s}
.s6-confetti:nth-child(2){top:7%;left:30%;animation-delay:.3s}
.s6-confetti:nth-child(3){top:2%;left:50%;animation-delay:.6s}
.s6-confetti:nth-child(4){top:9%;left:70%;animation-delay:.2s}
.s6-confetti:nth-child(5){top:5%;left:88%;animation-delay:.5s}

.s6-ufo{
  position:absolute;top:10%;right:10%;
  opacity:0;transition:opacity .4s ease 2s;
}
.scene.active .s6-ufo{opacity:.7}
.s6-ufo .ufo{animation:hover 2s ease-in-out infinite;transform:scale(.6)}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   SCENE 7: CTA
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.s7-bg{position:absolute;inset:0;background:radial-gradient(ellipse at 50% 50%,#0a0a2e,#050510)}
.s7-content{text-align:center;z-index:200;position:relative;padding:20px;padding-bottom:80px}
.s7-title{
  font-family:var(--comic);font-size:clamp(20px,4vw,36px);color:var(--green);
  margin-bottom:clamp(4px,.8vw,8px);
  opacity:0;transform:translateY(12px);transition:opacity .5s ease .3s,transform .5s ease .3s;
}
.scene.active .s7-title{opacity:1;transform:translateY(0)}
.s7-text{
  color:rgba(255,255,255,.6);font-size:clamp(10px,1.6vw,14px);
  margin-bottom:clamp(10px,2vw,20px);line-height:1.6;
  opacity:0;transition:opacity .5s ease .6s;
}
.scene.active .s7-text{opacity:1}
.s7-btns{display:flex;gap:clamp(6px,1.2vw,12px);justify-content:center;flex-wrap:wrap;opacity:0;transition:opacity .5s ease .9s;position:relative;z-index:200}
.scene.active .s7-btns{opacity:1}
.s7-btn{
  display:inline-flex;align-items:center;gap:6px;
  padding:clamp(8px,1.4vw,12px) clamp(14px,2.8vw,24px);
  border-radius:10px;font-family:var(--body);font-size:clamp(10px,1.6vw,14px);
  font-weight:700;text-decoration:none;border:none;cursor:pointer;transition:transform .2s;
}
.s7-btn:hover{transform:translateY(-2px)}
.s7-btn--g{background:var(--green);color:#fff}
.s7-btn--b{background:var(--blue);color:#fff}
.s7-btn--share{background:rgba(255,255,255,.15);color:#fff;border:1px solid rgba(255,255,255,.3)}
.s7-btn--share:hover{background:rgba(255,255,255,.25)}
.share-toast{position:fixed;bottom:80px;left:50%;transform:translateX(-50%);background:rgba(0,0,0,.85);color:#fff;padding:10px 20px;border-radius:20px;font-size:13px;z-index:9999;opacity:0;transition:opacity .3s;pointer-events:none}
.share-toast.show{opacity:1}

/* Tap-to-Start Splash */
.splash{position:absolute;inset:0;z-index:500;background:rgba(0,0,0,.7);display:flex;align-items:center;justify-content:center;cursor:pointer;backdrop-filter:blur(4px)}
.splash__btn{background:var(--green);color:#fff;border:none;border-radius:50%;width:clamp(60px,14vw,90px);height:clamp(60px,14vw,90px);font-size:clamp(24px,5vw,40px);cursor:pointer;animation:splash-pulse 1.5s ease-in-out infinite;box-shadow:0 0 30px rgba(104,146,70,.5)}
@keyframes splash-pulse{0%,100%{transform:scale(1);box-shadow:0 0 30px rgba(104,146,70,.4)}50%{transform:scale(1.08);box-shadow:0 0 50px rgba(104,146,70,.6)}}
.s7-credit{margin-top:clamp(10px,2vw,20px);color:rgba(255,255,255,.3);font-size:clamp(8px,1.2vw,11px)}
.s7-credit a{color:rgba(255,255,255,.45);text-decoration:none}
.s7-alien{
  position:absolute;bottom:clamp(10px,3vw,30px);right:clamp(10px,3vw,30px);
  opacity:0;transition:opacity .3s ease 1.2s;
}
.scene.active .s7-alien{opacity:.5}

/* End-scene Veloxaner crest */
.s7-crest{
  width:clamp(40px,8vw,64px);height:clamp(40px,8vw,64px);
  margin:0 auto clamp(6px,1.2vw,12px);position:relative;
  cursor:pointer;transition:transform .3s;
  opacity:0;transform:scale(.5);transition:opacity .4s ease .1s,transform .4s ease .1s;
}
.scene.active .s7-crest{opacity:1;transform:scale(1)}
.s7-crest:hover{transform:scale(1.15) rotate(5deg)!important;filter:drop-shadow(0 0 12px rgba(76,175,80,.5))}
.s7-crest__shield{
  position:absolute;inset:0;
  background:radial-gradient(circle at 40% 30%,#2E7D32,#1B5E20);
  border-radius:50% 50% 50% 50% / 40% 40% 60% 60%;
  border:2px solid rgba(255,255,255,.3);
  box-shadow:0 0 16px rgba(76,175,80,.3),inset 0 2px 4px rgba(255,255,255,.15);
}
.s7-crest__star{
  position:absolute;top:14%;left:50%;transform:translateX(-50%);
  font-size:clamp(8px,1.6vw,14px);color:#FFD93D;
  text-shadow:0 0 6px rgba(255,217,61,.5);line-height:1;
}
.s7-crest__wh1,.s7-crest__wh2{
  position:absolute;bottom:22%;
  width:clamp(10px,2vw,16px);height:clamp(10px,2vw,16px);
  border:2px solid #FFD93D;border-radius:50%;
  box-shadow:0 0 4px rgba(255,217,61,.3);
}
.s7-crest__wh1::after,.s7-crest__wh2::after{
  content:'';position:absolute;inset:28%;background:#FFD93D;border-radius:50%;
}
.s7-crest__wh1{left:16%}
.s7-crest__wh2{right:16%}
/* Mission rating */
.s7-mission{
  font-size:clamp(9px,1.4vw,12px);color:rgba(100,200,255,.6);
  letter-spacing:1px;text-transform:uppercase;margin-bottom:clamp(6px,1.2vw,10px);
  opacity:0;transition:opacity .5s ease .2s;
}
.scene.active .s7-mission{opacity:1}

/* â”€â”€ Easter Egg: Veloxaner-Akte â”€â”€ */
.dossier{
  display:none;position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);
  z-index:200;width:clamp(260px,60vw,380px);
  background:linear-gradient(135deg,#0a1628,#0d2240);
  border:1px solid rgba(100,200,255,.2);
  border-radius:14px;padding:clamp(14px,2.8vw,24px);
  box-shadow:0 0 40px rgba(100,200,255,.15),0 20px 60px rgba(0,0,0,.5);
  color:#fff;font-family:var(--body);
}
.dossier.open{display:block;animation:dossier-in .3s ease}
@keyframes dossier-in{from{opacity:0;transform:translate(-50%,-50%) scale(.8)}to{opacity:1;transform:translate(-50%,-50%) scale(1)}}
.dossier__close{
  position:absolute;top:8px;right:12px;
  background:none;border:none;color:rgba(255,255,255,.4);
  font-size:16px;cursor:pointer;
}
.dossier__close:hover{color:#fff}
.dossier__title{
  font-size:clamp(13px,2.2vw,18px);font-weight:800;
  color:rgba(100,200,255,.8);letter-spacing:2px;text-align:center;
  margin-bottom:clamp(10px,2vw,16px);
  text-shadow:0 0 8px rgba(100,200,255,.3);
}
.dossier__line{
  display:flex;justify-content:space-between;
  padding:clamp(4px,.8vw,7px) 0;
  border-bottom:1px solid rgba(100,200,255,.08);
  font-size:clamp(10px,1.6vw,13px);
}
.dossier__label{color:rgba(100,200,255,.5);font-weight:600;min-width:40%}
.dossier__stamp{
  text-align:center;margin-top:clamp(10px,2vw,16px);
  font-size:clamp(14px,2.4vw,20px);font-weight:800;
  color:rgba(76,175,80,.6);letter-spacing:3px;
  transform:rotate(-5deg);
  text-shadow:0 0 6px rgba(76,175,80,.2);
}

/* â”€â”€â”€ Controls â”€â”€â”€ */
.controls{position:absolute;bottom:6px;left:50%;transform:translateX(-50%);z-index:100;display:flex;align-items:center;gap:10px}
.ctrl{background:rgba(255,255,255,.12);backdrop-filter:blur(6px);border:none;color:#fff;width:32px;height:32px;border-radius:50%;font-size:14px;cursor:pointer;transition:background .2s;display:flex;align-items:center;justify-content:center}
.ctrl:hover{background:rgba(255,255,255,.25)}
.prog{width:clamp(100px,26vw,260px);height:3px;background:rgba(255,255,255,.15);border-radius:2px;overflow:hidden}
.prog__bar{height:100%;background:var(--green);border-radius:2px;width:0;transition:width .3s linear}
.sc-num{color:rgba(255,255,255,.4);font-size:10px;font-weight:600;min-width:32px;text-align:center}
.replay{
  position:absolute;top:10px;right:10px;z-index:100;
  background:rgba(255,255,255,.1);backdrop-filter:blur(6px);border:none;
  color:rgba(255,255,255,.5);padding:5px 12px;border-radius:16px;
  font-family:var(--body);font-size:10px;font-weight:600;cursor:pointer;
  opacity:0;transition:opacity .3s;
}
.replay.show{opacity:1}.replay:hover{background:rgba(255,255,255,.2);color:#fff}
</style>
</head>
<body>

<div class="cinema">

  <!-- Tap to Start -->
  <div class="splash" id="splash" onclick="startFilm()">
    <button class="splash__btn">â–¶</button>
  </div>

  <!-- SCENE 0: Title -->
  <div class="scene active" data-duration="5000">
    <div class="s0-bg"><div class="s0-stars" id="stars"></div></div>
    <div class="s0-ufo"><div class="ufo"><div class="ufo__body"><div class="ufo__disc"></div><div class="ufo__dome"></div><div class="ufo__dots"><div class="ufo__dot"></div><div class="ufo__dot"></div><div class="ufo__dot"></div><div class="ufo__dot"></div></div><div class="ufo__rim"></div></div><div class="ufo__crest"><div class="ufo__crest-shield"></div><div class="ufo__crest-wh1"></div><div class="ufo__crest-wh2"></div><div class="ufo__crest-frame"></div><div class="ufo__crest-star">â˜…</div></div><div class="ufo__hitch"><div class="ufo__hitch-bar"></div><div class="ufo__hitch-ball"></div></div><div class="ufo__light"></div></div></div>
    <div class="s0-content">
      <div class="s0-logbook">ğŸ“¡ Logbuch der Veloxflotte Â· Eintrag 247</div>
      <div class="s0-logo"><span class="gr">Radwege</span><span class="bl">melder</span></div>
      <div class="s0-tagline">ğŸ›¸ Meldi geht ein Licht auf</div>
      <div class="s0-subtitle">Ein auÃŸerirdisch guter Kurzfilm</div>
    </div>
  </div>

  <!-- SCENE 1: Landing -->
  <div class="scene" data-duration="8000">
    <div class="s1-bg"></div>
    <div class="s1-stars" id="stars2s1"></div>
    <div class="s1-moon"></div>
    <div class="s1-hills"></div>
    <div class="s1-tree s1-tree--1"></div>
    <div class="s1-tree s1-tree--2"></div>
    <div class="s1-tree s1-tree--3"></div>
    <div class="s1-tree s1-tree--4"></div>
    <div class="s1-tree s1-tree--5"></div>
    <div class="s1-ufo"><div class="ufo"><div class="ufo__body"><div class="ufo__disc"></div><div class="ufo__dome"></div><div class="ufo__dots"><div class="ufo__dot"></div><div class="ufo__dot"></div><div class="ufo__dot"></div><div class="ufo__dot"></div></div><div class="ufo__rim"></div></div><div class="ufo__crest"><div class="ufo__crest-shield"></div><div class="ufo__crest-wh1"></div><div class="ufo__crest-wh2"></div><div class="ufo__crest-frame"></div><div class="ufo__crest-star">â˜…</div></div><div class="ufo__hitch"><div class="ufo__hitch-bar"></div><div class="ufo__hitch-ball"></div></div><div class="ufo__light"></div></div></div>
    <div class="s1-beam"></div>
    <div class="s1-beamring"></div>
    <div class="s1-alien"><div class="alien alien--excited"><div class="alien__antenna"></div><div class="alien__head"><div class="alien__eye alien__eye--l"><div class="alien__pupil"></div></div><div class="alien__eye alien__eye--r"><div class="alien__pupil"></div></div><div class="alien__mouth"></div></div><div class="alien__body"></div><div class="alien__arm alien__arm--l"></div><div class="alien__arm alien__arm--r"></div><div class="alien__hand alien__hand--l"></div><div class="alien__hand alien__hand--r"></div><div class="alien__leg alien__leg--l"></div><div class="alien__leg alien__leg--r"></div><div class="alien__shoe alien__shoe--l"></div><div class="alien__shoe alien__shoe--r"></div></div></div>
    <div class="s1-sign"><div class="s1-sign__plate">Willkommen im Saarland</div><div class="s1-sign__post"></div></div>
    <div class="speech speech--alien d2" style="top:18%;left:8%;max-width:220px">Endlich! Deutschland â€“ die berÃ¼hmte Fahrradnation! ğŸš²âœ¨</div>
    <div class="sub"><div class="sub__text">Meldi gehÃ¶rt zu den Veloxanern â€“ ein Volk von Velofahrern mit der Mission, allen Planeten Fahrradfreundlichkeit beizubringen.</div></div>
  </div>

  <!-- SCENE 2: Chaos -->
  <div class="scene" data-duration="9000">
    <div class="s2-bg"></div>
    <div class="s2-alien-bike">
      <div class="alien-bike">
        <div class="alien alien--shocked"><div class="alien__antenna"></div><div class="alien__head"><div class="alien__eye alien__eye--l"><div class="alien__pupil"></div></div><div class="alien__eye alien__eye--r"><div class="alien__pupil"></div></div><div class="alien__mouth"></div></div><div class="alien__body"></div><div class="alien__arm alien__arm--l"></div><div class="alien__arm alien__arm--r"></div><div class="alien__hand alien__hand--l"></div><div class="alien__hand alien__hand--r"></div></div>
        <div class="alien-bike__frame"></div>
        <div class="alien-bike__wheels"><div class="alien-bike__wh"></div><div class="alien-bike__wh"></div></div>
      </div>
    </div>
    <div class="s2-obstacles">
      <div class="s2-hole s2-hole--1"></div>
      <div class="s2-hole s2-hole--2"></div>
      <div class="s2-crack">ğŸ’¥</div>
      <div class="s2-car"></div>
      <div class="s2-parkcar"></div>
      <div class="s2-psign">P</div>
    </div>
    <div class="s2-effects">
      <div class="s2-fx">KRACH!</div>
      <div class="s2-fx">WUMM!</div>
      <div class="s2-fx">AUTSCH!</div>
    </div>
    <div class="speech speech--red d2" style="top:12%;left:5%;max-width:240px">Fahrradnation?! SchlaglÃ¶cher! Zugeparkt! Wo bin ich hier gelandet?! ğŸ˜±</div>
    <div class="sub"><div class="sub__text">Die RealitÃ¤t trifft Meldi wie ein Bordstein. SchlaglÃ¶cher, Falschparker, Engstellen Ã¼berall.</div></div>
  </div>

  <!-- SCENE 3: Discovers app -->
  <div class="scene" data-duration="8000">
    <div class="s3-bg"></div>
    <div class="s3-alien"><div class="alien"><div class="alien__antenna"></div><div class="alien__head"><div class="alien__eye alien__eye--l"><div class="alien__pupil"></div></div><div class="alien__eye alien__eye--r"><div class="alien__pupil"></div></div><div class="alien__mouth"></div></div><div class="alien__body"></div><div class="alien__arm alien__arm--l"></div><div class="alien__arm alien__arm--r"></div><div class="alien__hand alien__hand--l"></div><div class="alien__hand alien__hand--r"></div><div class="alien__leg alien__leg--l"></div><div class="alien__leg alien__leg--r"></div><div class="alien__shoe alien__shoe--l"></div><div class="alien__shoe alien__shoe--r"></div></div></div>
    <div class="s3-phone">
      <div class="s3-screen">
        <div class="s3-hdr">RADWEGE<span>MELDER</span></div>
        <div class="s3-items">
          <div class="s3-item s3-item--r">âš ï¸ Problem</div>
          <div class="s3-item s3-item--y">ğŸ’¬ Wunsch</div>
          <div class="s3-item s3-item--g">ğŸ‘ Positiv</div>
        </div>
        <div class="s3-map"><div class="s3-pin">ğŸ“</div><div class="s3-ring"></div></div>
      </div>
    </div>
    <div class="s3-lightbulb">ğŸ’¡</div>
    <div class="speech speech--alien d3" style="top:8%;right:5%;max-width:230px">Oh! Die Erdlinge haben eine App dafÃ¼r! Einfach melden â€“ selbst mit 3 Fingern! ğŸ‘½ğŸ“±</div>
    <div class="sub"><div class="sub__text">Meldi entdeckt den Radwegemelder. Keine Installation, kein Account â€“ einfach melden!</div></div>
  </div>

  <!-- SCENE 4: Reporting frenzy -->
  <div class="scene" data-duration="9000">
    <div class="s4-bg"></div>
    <div class="s4-alien"><div class="alien alien--happy"><div class="alien__antenna"></div><div class="alien__head"><div class="alien__eye alien__eye--l"><div class="alien__pupil"></div></div><div class="alien__eye alien__eye--r"><div class="alien__pupil"></div></div><div class="alien__mouth"></div></div><div class="alien__body"></div><div class="alien__arm alien__arm--l"></div><div class="alien__arm alien__arm--r"></div><div class="alien__hand alien__hand--l"></div><div class="alien__hand alien__hand--r"></div><div class="alien__leg alien__leg--l"></div><div class="alien__leg alien__leg--r"></div><div class="alien__shoe alien__shoe--l"></div><div class="alien__shoe alien__shoe--r"></div></div></div>
    <div class="s4-pings">
      <div class="s4-ping" style="top:25%;left:38%">ğŸ“ğŸ”´</div>
      <div class="s4-ping" style="top:35%;left:55%">ğŸ“ğŸ”´</div>
      <div class="s4-ping" style="top:20%;left:70%">ğŸ“ğŸŸ¡</div>
      <div class="s4-ping" style="top:45%;left:60%">ğŸ“ğŸ”´</div>
      <div class="s4-ping" style="top:30%;left:82%">ğŸ“ğŸŸ¢</div>
    </div>
    <div class="s4-counter" id="counter"><span class="s4-counter__num" id="counterNum">0</span></div>
    <div class="speech speech--alien d1" style="bottom:55%;left:5%;max-width:230px">Ich hab sogar eine fahrradfreundliche Einkehr auf der Karte gefunden! ğŸºğŸš² Man kann auch gute Sachen melden!</div>
    <div class="sub"><div class="sub__text">Meldi meldet alles â€“ SchlaglÃ¶cher, WÃ¼nsche, und sogar eine fahrradfreundliche Einkehr!<br>Die SaarlÃ¤nder lieben das.</div></div>
  </div>

  <!-- SCENE 5: Municipality sees data -->
  <div class="scene" data-duration="8000">
    <div class="s5-bg"></div>
    <div class="s5-dash">
      <div class="s5-dhdr"><span>ğŸ“Š Dashboard</span><span>Lebach</span></div>
      <div class="s5-stats">
        <div class="s5-stat"><div class="s5-stat__n" style="color:#E00000">47</div><div class="s5-stat__l">Probleme</div></div>
        <div class="s5-stat"><div class="s5-stat__n" style="color:#E5A700">18</div><div class="s5-stat__l">WÃ¼nsche</div></div>
        <div class="s5-stat"><div class="s5-stat__n" style="color:#00A836">12</div><div class="s5-stat__l">Positiv</div></div>
      </div>
      <div class="s5-map">
        <div class="s5-pin" style="top:20%;left:20%">ğŸ”´</div>
        <div class="s5-pin" style="top:50%;left:45%">ğŸ”´</div>
        <div class="s5-pin" style="top:30%;left:65%">ğŸŸ¡</div>
        <div class="s5-pin" style="top:60%;left:25%">ğŸ”´</div>
        <div class="s5-pin" style="top:40%;left:80%">ğŸŸ¢</div>
        <div class="s5-pin" style="top:70%;left:55%">ğŸ”´</div>
      </div>
    </div>
    <div class="s5-people">ğŸ‘©â€ğŸ’¼ğŸ‘¨â€ğŸ’»</div>
    <div class="speech speech--green d2" style="top:8%;right:5%;max-width:240px">77 Meldungen! Die BÃ¼rger zeigen uns genau, wo es hakt. Das sind echte Daten! ğŸ“Š</div>
    <div class="sub"><div class="sub__text">Die Kommune sieht alle Meldungen auf der Karte â€“ professionell aufbereitet fÃ¼r Gremien.</div></div>
  </div>

  <!-- SCENE 6: Happy ending -->
  <div class="scene" data-duration="8000">
    <div class="s6-bg"></div>
    <div class="s6-sun"></div>
    <div class="s6-confetti">ğŸ‰</div><div class="s6-confetti">â­</div><div class="s6-confetti">ğŸŠ</div><div class="s6-confetti">âœ¨</div><div class="s6-confetti">ğŸ›¸</div>
    <div class="s6-path"><div class="s6-path__label">âœ¨ Bessere & neue Radwege</div></div>
    <div class="s6-alien-bike">
      <div class="alien-bike">
        <div class="alien alien--happy"><div class="alien__antenna"></div><div class="alien__head"><div class="alien__eye alien__eye--l"><div class="alien__pupil"></div></div><div class="alien__eye alien__eye--r"><div class="alien__pupil"></div></div><div class="alien__mouth"></div></div><div class="alien__body"></div><div class="alien__arm alien__arm--l"></div><div class="alien__arm alien__arm--r"></div><div class="alien__hand alien__hand--l"></div><div class="alien__hand alien__hand--r"></div></div>
        <div class="alien-bike__frame"></div>
        <div class="alien-bike__wheels"><div class="alien-bike__wh"></div><div class="alien-bike__wh"></div></div>
      </div>
    </div>
    <div class="s6-ufo"><div class="ufo"><div class="ufo__body"><div class="ufo__disc"></div><div class="ufo__dome"></div><div class="ufo__dots"><div class="ufo__dot"></div><div class="ufo__dot"></div><div class="ufo__dot"></div><div class="ufo__dot"></div></div><div class="ufo__rim"></div></div><div class="ufo__crest"><div class="ufo__crest-shield"></div><div class="ufo__crest-wh1"></div><div class="ufo__crest-wh2"></div><div class="ufo__crest-frame"></div><div class="ufo__crest-star">â˜…</div></div><div class="ufo__hitch"><div class="ufo__hitch-bar"></div><div class="ufo__hitch-ball"></div></div><div class="ufo__light"></div></div></div>
    <div class="speech speech--alien speech--top d3" style="top:5%;left:10%;max-width:260px">Ich erzÃ¤hl allen Veloxanern von euch â€“ Mission Saarland: fast geschafft! ğŸ›¸ğŸš²ğŸ’š</div>
    <div class="sub"><div class="sub__text">Mission erfÃ¼llt! Meldi hat gezeigt: BÃ¼rgerdaten werden zu besseren Radwegen.</div></div>
  </div>

  <!-- SCENE 7: CTA -->
  <div class="scene" data-duration="0">
    <div class="s7-bg"><div class="s0-stars" id="stars2"></div></div>
    <div class="s7-content">
      <div class="s7-crest" id="easterEggCrest" title="ğŸ¥š Klick mich!">
        <div class="s7-crest__shield"></div>
        <div class="s7-crest__star">â˜…</div>
        <div class="s7-crest__wh1"></div>
        <div class="s7-crest__wh2"></div>
      </div>
      <div class="s7-mission">Mission Saarland Â· Status: â­â­â­ von 5 â€“ ausbaufÃ¤hig!</div>
      <div class="s7-title">ğŸš² Machen Sie Ihre Kommune fahrradfreundlich!</div>
      <div class="s7-text">Machen Sie es wie Meldi â€“ nutzen Sie den Radwegemelder!<br>Kostenlos Â· Anonym Â· Keine Installation nÃ¶tig</div>
      <div class="s7-btns">
        <a href="https://2rat.github.io/velomeld/" class="s7-btn s7-btn--g" target="_blank">ğŸ“± Jetzt ausprobieren</a>
        <a href="mailto:fahr2rat@gmail.com" class="s7-btn s7-btn--b">âœ‰ï¸ Beratung anfragen</a>
        <button class="s7-btn s7-btn--share" onclick="shareFilm()">ğŸ“¤ Teilen</button>
      </div>
      <div class="s7-credit"><a href="https://www.2rat.org">2Rat â€“ BÃ¼ro fÃ¼r Radverkehrsplanung</a> Â· Armin Jung Â· <a href="mailto:fahr2rat@gmail.com">fahr2rat@gmail.com</a></div>
    </div>
    <!-- Easter Egg Dossier -->
    <div class="dossier" id="dossier">
      <div class="dossier__close" onclick="closeDossier()">âœ•</div>
      <div class="dossier__title">ğŸ›¸ VELOXANER-AKTE</div>
      <div class="dossier__line"><span class="dossier__label">Spezies</span><span>Veloxaner</span></div>
      <div class="dossier__line"><span class="dossier__label">Heimatplanet</span><span>Velox (Galaxie M87)</span></div>
      <div class="dossier__line"><span class="dossier__label">Agent</span><span>Meldi Â· Klasse V</span></div>
      <div class="dossier__line"><span class="dossier__label">Raumschiff</span><span>VX-247 "Speiche"</span></div>
      <div class="dossier__line"><span class="dossier__label">Mission</span><span>Fahrradfreundlichkeit auf allen Planeten</span></div>
      <div class="dossier__line"><span class="dossier__label">Aktueller Einsatz</span><span>Saarland, Planet Erde</span></div>
      <div class="dossier__line"><span class="dossier__label">Status</span><span>â­â­â­ â€“ ausbaufÃ¤hig, aber die melden jetzt!</span></div>
      <div class="dossier__line"><span class="dossier__label">SpezialausrÃ¼stung</span><span>Radwegemelder-App ğŸ“±</span></div>
      <div class="dossier__line"><span class="dossier__label">Lieblingsgericht</span><span>Schwenker mit Radler ğŸ¥©ğŸº</span></div>
      <div class="dossier__stamp">GENEHMIGT âœ“</div>
    </div>
    <div class="s7-alien"><div class="alien"><div class="alien__antenna"></div><div class="alien__head"><div class="alien__eye alien__eye--l"><div class="alien__pupil"></div></div><div class="alien__eye alien__eye--r"><div class="alien__pupil"></div></div><div class="alien__mouth"></div></div><div class="alien__body"></div><div class="alien__arm alien__arm--l"></div><div class="alien__arm alien__arm--r"></div><div class="alien__hand alien__hand--l"></div><div class="alien__hand alien__hand--r"></div><div class="alien__leg alien__leg--l"></div><div class="alien__leg alien__leg--r"></div><div class="alien__shoe alien__shoe--l"></div><div class="alien__shoe alien__shoe--r"></div></div></div>
  </div>

  <!-- Controls -->
  <div class="controls">
    <button class="ctrl" id="playBtn" onclick="togglePlay()">â¸</button>
    <div class="prog"><div class="prog__bar" id="progBar"></div></div>
    <div class="sc-num" id="scNum">1/8</div>
    <button class="ctrl" onclick="prevScene()">â®</button>
    <button class="ctrl" onclick="nextScene()">â­</button>
  </div>
  <button class="replay" id="replayBtn" onclick="replay()">â†» Nochmal</button>
</div>

<script>
// Stars
function makeStars(id){const c=document.getElementById(id);if(!c)return;for(let i=0;i<40;i++){const s=document.createElement('div');s.className='star';const sz=Math.random()*2.5+.5;s.style.cssText=`width:${sz}px;height:${sz}px;top:${Math.random()*100}%;left:${Math.random()*100}%;animation-delay:${Math.random()*3}s;animation-duration:${Math.random()*2+1.5}s`;c.appendChild(s)}}
makeStars('stars');makeStars('stars2');

// Easter Egg: Veloxaner-Akte
document.getElementById('easterEggCrest').addEventListener('click',function(){
  document.getElementById('dossier').classList.add('open');
});
function closeDossier(){document.getElementById('dossier').classList.remove('open');}
// Close dossier on outside click
document.getElementById('dossier').addEventListener('click',function(e){
  if(e.target===this)closeDossier();
});
// Scene 1 stars
(function(){const c=document.getElementById('stars2s1');if(!c)return;for(let i=0;i<30;i++){const s=document.createElement('div');s.className='s1-star';const sz=Math.random()*2+.5;s.style.cssText=`width:${sz}px;height:${sz}px;top:${Math.random()*45}%;left:${Math.random()*100}%;animation-delay:${Math.random()*3}s`;c.appendChild(s)}})();

const scenes=document.querySelectorAll('.scene');
const total=scenes.length;
let cur=0,playing=true,timer=null;

// Counter animation for scene 4
let counterInterval=null;
function startCounter(){
  let n=0;const el=document.getElementById('counterNum');
  if(counterInterval)clearInterval(counterInterval);
  el.textContent='0';
  counterInterval=setInterval(()=>{n++;el.textContent=n;if(n>=47)clearInterval(counterInterval)},90);
}
function stopCounter(){if(counterInterval){clearInterval(counterInterval);counterInterval=null}}

// Wake Lock: Bildschirm bleibt an wÃ¤hrend Film lÃ¤uft
var wakeLock=null;
async function requestWake(){
  try{if('wakeLock' in navigator){wakeLock=await navigator.wakeLock.request('screen');}}catch(e){}
}
function releaseWake(){
  if(wakeLock){wakeLock.release();wakeLock=null;}
}
document.addEventListener('visibilitychange',()=>{if(document.visibilityState==='visible'&&playing)requestWake();});

function goTo(idx){
  stopCounter();
  var prev=cur;
  cur=idx;
  scenes[cur].classList.add('active');
  // Remove old scene after new one is visible (cross-fade)
  setTimeout(()=>{
    scenes.forEach((s,i)=>{if(i!==cur)s.classList.remove('active');});
  },50);
  if(cur===4)setTimeout(startCounter,600);
  updateUI();scheduleNext();
}
function scheduleNext(){
  clearTimeout(timer);if(!playing)return;
  const dur=parseInt(scenes[cur].dataset.duration);
  if(dur>0){timer=setTimeout(()=>{if(cur<total-1)goTo(cur+1);else{playing=false;releaseWake();updateUI();if(window.toggleMusic&&document.querySelector('.mus-on'))window.toggleMusic();}},dur)}
  else{playing=false;releaseWake();updateUI();if(window.toggleMusic&&document.querySelector('.mus-on'))window.toggleMusic();}
}
function togglePlay(){playing=!playing;updateUI();if(playing){requestWake();if(cur>=total-1)goTo(0);else scheduleNext()}else{clearTimeout(timer);releaseWake();}}
function nextScene(){if(cur<total-1)goTo(cur+1)}
function prevScene(){if(cur>0)goTo(cur-1)}
function replay(){playing=true;requestWake();goTo(0)}
function updateUI(){
  document.getElementById('playBtn').textContent=playing?'â¸':'â–¶';
  document.getElementById('scNum').textContent=(cur+1)+'/'+total;
  document.getElementById('progBar').style.width=((cur+1)/total*100)+'%';
  document.getElementById('replayBtn').classList.toggle('show',cur>=total-1&&!playing);
}
// Film startet pausiert auf Szene 0, wartet auf Tap
playing=false;
goTo(0);

function startFilm(){
  var sp=document.getElementById('splash');
  sp.style.opacity='0';sp.style.pointerEvents='none';
  setTimeout(()=>sp.remove(),500);
  playing=true;requestWake();updateUI();scheduleNext();
}

// === TEILEN ===
function shareFilm(){
  var shareData={
    title:'Meldis Mission â€“ Radwegemelder',
    text:'Schau dir an wie Meldi ein Licht aufgeht! ğŸš²ğŸ›¸',
    url:'https://www.2rat.org/film.html'
  };
  if(navigator.share){
    navigator.share(shareData).catch(()=>{});
  } else {
    navigator.clipboard.writeText(shareData.url).then(()=>{
      var t=document.getElementById('shareToast');
      t.classList.add('show');setTimeout(()=>t.classList.remove('show'),2000);
    });
  }
}

// === SWIPE-GESTEN ===
(function(){
  var sx=0,sy=0,cinema=document.querySelector('.cinema');
  cinema.addEventListener('touchstart',function(e){sx=e.touches[0].clientX;sy=e.touches[0].clientY;},{passive:true});
  cinema.addEventListener('touchend',function(e){
    var dx=e.changedTouches[0].clientX-sx;
    var dy=e.changedTouches[0].clientY-sy;
    if(Math.abs(dx)>50&&Math.abs(dx)>Math.abs(dy)*1.5){
      if(dx<0)nextScene(); else prevScene();
    }
  },{passive:true});
})();

// === VIBRATION bei Szene 2 (Bordstein-Schock) ===
var origGoTo=goTo;
goTo=function(idx){
  origGoTo(idx);
  if(idx===2&&navigator.vibrate)navigator.vibrate([50,30,80]);
};

// === MELDI SOUNDTRACK v3: Cinematischer Kurzfilm-Score ===
// Durchgehend, adaptiv, filmisch. Kein Loop-GefÃ¼hl.
(function(){
var ax=null,mg=null,mp=false,lt=null,curScene=0;

function ini(){
  if(ax&&ax.state!=='closed')return;
  ax=new(window.AudioContext||window.webkitAudioContext)();
  mg=ax.createGain();mg.gain.value=0;mg.connect(ax.destination);
}

// === INSTRUMENTE ===

// Warmes Pad (FilmflÃ¤che, chorisch)
function pad(freq,t,d,vol){
  var detune=[0,0.5,-0.5,1.002];
  detune.forEach(function(dt,i){
    var o=ax.createOscillator(),g=ax.createGain();
    var fl=ax.createBiquadFilter();
    o.type=i<2?'sine':'triangle';
    o.frequency.setValueAtTime(freq*((i===3)?dt:1),t);
    if(i<3)o.detune.setValueAtTime(dt*100,t);
    fl.type='lowpass';fl.frequency.setValueAtTime(freq*3,t);
    var v=vol*0.06/(i*0.5+1);
    g.gain.setValueAtTime(0.0001,t);
    g.gain.linearRampToValueAtTime(v,t+d*0.25);
    g.gain.setValueAtTime(v*0.85,t+d*0.7);
    g.gain.linearRampToValueAtTime(0.0001,t+d);
    o.connect(fl);fl.connect(g);g.connect(mg);o.start(t);o.stop(t+d+.1);
  });
}

// Marimba/Xylophon (warm, holzig - ersetzt das kalte Pizzicato)
function marimba(freq,t,vol){
  var o=ax.createOscillator(),o2=ax.createOscillator();
  var g=ax.createGain(),fl=ax.createBiquadFilter();
  o.type='sine';o.frequency.setValueAtTime(freq,t);
  o2.type='sine';o2.frequency.setValueAtTime(freq*4,t);
  fl.type='lowpass';fl.frequency.setValueAtTime(freq*6,t);
  fl.frequency.exponentialRampToValueAtTime(freq*2,t+0.2);
  g.gain.setValueAtTime(vol*0.14,t);
  g.gain.exponentialRampToValueAtTime(vol*0.06,t+0.08);
  g.gain.exponentialRampToValueAtTime(0.0001,t+0.5);
  o.connect(fl);o2.connect(g);fl.connect(g);g.connect(mg);
  o.start(t);o2.start(t);o.stop(t+0.6);o2.stop(t+0.6);
}

// FlÃ¶te (weicher, wÃ¤rmer als vorher)
function flute(freq,t,d,vol){
  var o=ax.createOscillator(),g=ax.createGain(),fl=ax.createBiquadFilter();
  o.type='sine';o.frequency.setValueAtTime(freq,t);
  // Vibrato
  var lfo=ax.createOscillator(),lfoG=ax.createGain();
  lfo.frequency.setValueAtTime(5,t);lfoG.gain.setValueAtTime(3,t);
  lfo.connect(lfoG);lfoG.connect(o.frequency);lfo.start(t);lfo.stop(t+d+.1);
  fl.type='lowpass';fl.frequency.setValueAtTime(freq*2.5,t);
  var v=vol*0.09;
  g.gain.setValueAtTime(0.0001,t);
  g.gain.linearRampToValueAtTime(v,t+0.1);
  g.gain.setValueAtTime(v*0.9,t+d*0.7);
  g.gain.linearRampToValueAtTime(0.0001,t+d);
  o.connect(fl);fl.connect(g);g.connect(mg);o.start(t);o.stop(t+d+.1);
}

// Celesta (magisch, glitzernd)
function celesta(freq,t,vol){
  [1,2,3,5].forEach(function(h,i){
    var o=ax.createOscillator(),g=ax.createGain();
    o.type='sine';o.frequency.setValueAtTime(freq*h,t);
    var v=vol*0.035/Math.pow(i+1,0.7);
    g.gain.setValueAtTime(v,t);
    g.gain.exponentialRampToValueAtTime(0.0001,t+2.5-i*0.3);
    o.connect(g);g.connect(mg);o.start(t);o.stop(t+3);
  });
}

// Cello (tiefer, warmer Streicherton)
function cello(freq,t,d,vol){
  var o=ax.createOscillator(),o2=ax.createOscillator(),g=ax.createGain();
  o.type='sawtooth';o2.type='sawtooth';
  o.frequency.setValueAtTime(freq,t);o2.frequency.setValueAtTime(freq*1.003,t);
  var fl=ax.createBiquadFilter();fl.type='lowpass';fl.frequency.setValueAtTime(freq*3,t);
  var v=vol*0.04;
  g.gain.setValueAtTime(0.0001,t);
  g.gain.linearRampToValueAtTime(v,t+d*0.15);
  g.gain.setValueAtTime(v*0.8,t+d*0.75);
  g.gain.linearRampToValueAtTime(0.0001,t+d);
  o.connect(fl);o2.connect(fl);fl.connect(g);g.connect(mg);
  o.start(t);o2.start(t);o.stop(t+d+.1);o2.stop(t+d+.1);
  // Vibrato
  var lfo=ax.createOscillator(),lfoG=ax.createGain();
  lfo.frequency.setValueAtTime(5.5,t);lfoG.gain.setValueAtTime(2,t);
  lfo.connect(lfoG);lfoG.connect(o.frequency);lfo.start(t);lfo.stop(t+d+.1);
}

// Sanfte Percussion (Shaker statt harter Brush)
function shaker(t,vol){
  var d=0.06;
  var buf=ax.createBuffer(1,ax.sampleRate*d,ax.sampleRate);
  var dat=buf.getChannelData(0);
  for(var i=0;i<dat.length;i++)dat[i]=(Math.random()*2-1)*Math.pow(1-i/dat.length,0.5);
  var s=ax.createBufferSource(),g=ax.createGain(),fl=ax.createBiquadFilter();
  s.buffer=buf;fl.type='bandpass';fl.frequency.setValueAtTime(6000,t);fl.Q.setValueAtTime(1,t);
  g.gain.setValueAtTime(vol*0.04,t);g.gain.exponentialRampToValueAtTime(0.0001,t+d);
  s.connect(fl);fl.connect(g);g.connect(mg);s.start(t);s.stop(t+d+.01);
}

// Trommel (weicher Kick fÃ¼r HÃ¶hepunkte)
function kick(t,vol){
  var o=ax.createOscillator(),g=ax.createGain();
  o.type='sine';o.frequency.setValueAtTime(150,t);
  o.frequency.exponentialRampToValueAtTime(40,t+0.15);
  g.gain.setValueAtTime(vol*0.12,t);
  g.gain.exponentialRampToValueAtTime(0.0001,t+0.3);
  o.connect(g);g.connect(mg);o.start(t);o.stop(t+0.4);
}

// Drama-Hit (Schock-Stinger)
function stinger(t,vol){
  [185,233,277,330].forEach(function(f,i){
    var o=ax.createOscillator(),g=ax.createGain();
    o.type=i<2?'sawtooth':'triangle';o.frequency.setValueAtTime(f,t);
    var fl=ax.createBiquadFilter();fl.type='lowpass';
    fl.frequency.setValueAtTime(1200,t);fl.frequency.exponentialRampToValueAtTime(150,t+2);
    g.gain.setValueAtTime(vol*0.06,t);g.gain.exponentialRampToValueAtTime(0.0001,t+2);
    o.connect(fl);fl.connect(g);g.connect(mg);o.start(t);o.stop(t+2.5);
  });
  kick(t,vol*0.8);
}

// Harfe-Arpeggio (fÃ¼r magische Momente)
function harp(notes,t,spacing,vol){
  notes.forEach(function(f,i){
    var o=ax.createOscillator(),g=ax.createGain();
    o.type='sine';o.frequency.setValueAtTime(f,t+i*spacing);
    g.gain.setValueAtTime(vol*0.08,t+i*spacing);
    g.gain.exponentialRampToValueAtTime(0.0001,t+i*spacing+1.5);
    o.connect(g);g.connect(mg);o.start(t+i*spacing);o.stop(t+i*spacing+2);
  });
}

// Noten
var C2=65.41,D2=73.42,E2=82.41,F2=87.31,G2=98,A2=110,B2=123.47;
var C3=130.81,D3=146.83,E3=164.81,F3=174.61,G3=196,A3=220,B3=246.94;
var C4=261.63,D4=293.66,E4=329.63,F4=349.23,G4=392,A4=440,B4=493.88;
var C5=523.25,D5=587.33,E5=659.25,F5=698.46,G5=783.99,A5=880;

var BPM=100;
var BT=60/BPM;
var BAR=BT*4;

// ===================================================
// SZENE 0: Weltraum-Intro (weit, magisch, Sterne)
// ===================================================
function scene0(t0){
  pad(C3,t0,5,0.7);
  pad(G2,t0+0.5,4.5,0.5);
  pad(E3,t0+1,4,0.4);
  harp([C4,E4,G4,C5,E5],t0+1.2,0.25,0.5);
  celesta(G5,t0+2.5,0.35);
  celesta(C5*2,t0+3.5,0.3);
  flute(E4,t0+2.5,BT*2,0.25);
  flute(G4,t0+2.5+BT*2,BT*2.5,0.3);
  return 5;
}

// ===================================================
// SZENE 1: Landung auf der Erde (neugierig, verspielt)
// ===================================================
function scene1(t0){
  // Warmes Marimba-Pattern
  var m=[C4,E4,G4,E4,C4,G3,A3,C4, D4,F4,A4,F4,D4,A3,G3,E3];
  m.forEach(function(n,i){marimba(n,t0+i*BT*0.5,0.55);});
  // Neugierige FlÃ¶te
  flute(G4,t0+BT*0.5,BT*1.2,0.5);
  flute(A4,t0+BT*2,BT*0.8,0.5);
  flute(C5,t0+BT*3.5,BT*1.8,0.55);
  flute(A4,t0+BT*6,BT*0.8,0.45);
  flute(G4,t0+BT*7,BT*1.5,0.5);
  // Cello-Fundament
  cello(C3,t0,BAR,0.5);
  cello(F3,t0+BAR,BAR,0.5);
  // Leichter Shaker
  for(var i=0;i<16;i++){if(i%2===0)shaker(t0+i*BT*0.5,0.35);}
  celesta(C5*2,t0+BT*3,0.2);
  celesta(G5,t0+BT*7.5,0.2);
  return 8;
}

// ===================================================
// SZENE 2: Schlagloch-Schock (dramatisch â†’ nachdenklich)
// ===================================================
function scene2(t0){
  // Ahnungslose Marimba... kurz!
  marimba(E4,t0,0.4);
  marimba(G4,t0+0.3,0.4);
  // STINGER sofort bei ~0.7s!
  stinger(t0+0.7,0.8);
  // Kurze Stille... dann schnell nachdenklich
  cello(A2,t0+BT*3,BAR,0.6);
  cello(E3,t0+BT*3.5,BAR*0.8,0.45);
  // Traurige FlÃ¶te, schneller einsetzend
  flute(E4,t0+BT*4,BT*1.5,0.4);
  flute(D4,t0+BT*6,BT*2,0.35);
  flute(C4,t0+BT*8.5,BT*2.5,0.4);
  // Moll-Pad
  pad(A2,t0+BT*3,5,0.5);
  pad(E3,t0+BT*4,4,0.35);
  return 9;
}

// ===================================================
// SZENE 3: Entdeckung! (FROHLOCKEN! Jubelnd, magisch)
// ===================================================
function scene3(t0){
  // Sofort jubelnde Harfe aufwÃ¤rts!
  harp([C4,E4,G4,C5,E5,G5,C5*2],t0,0.1,0.65);
  // Celesta-Funkeln sofort - Magie!
  celesta(G5,t0+0.2,0.5);
  celesta(C5*2,t0+0.5,0.5);
  celesta(E5*2,t0+0.8,0.45);
  // Kick fÃ¼r den Wow-Moment
  kick(t0+0.3,0.4);
  // Jubelnde aufsteigende FlÃ¶te - Frohlocken!
  flute(C5,t0+BT*1.5,BT*0.5,0.6);
  flute(E5,t0+BT*2,BT*0.5,0.65);
  flute(G5,t0+BT*2.5,BT*0.5,0.65);
  flute(A5,t0+BT*3,BT*2,0.75); // HÃ¶hepunkt!
  // Zweite Jubel-Welle
  celesta(G5*2,t0+BT*3,0.5);
  celesta(C5*2,t0+BT*3.5,0.4);
  harp([G4,C5,E5,G5],t0+BT*3.5,0.12,0.5);
  // Frohe Marimba-Kaskade
  var m=[C4,E4,G4,C5,E5,G5,E5,C5,G4,C5,E5,G5];
  m.forEach(function(n,i){marimba(n,t0+BT*1+i*BT*0.35,0.45+i*0.02);});
  // Zufriedene FlÃ¶te danach
  flute(G5,t0+BT*5.5,BT*0.8,0.55);
  flute(E5,t0+BT*6.5,BT*0.8,0.55);
  flute(C5,t0+BT*7.5,BT*2,0.6);
  // Warmes Cello darunter
  cello(C3,t0+BT,BAR*1.5,0.6);
  cello(G2,t0+BAR*1.5+BT,BAR,0.55);
  // Shaker kommt frÃ¶hlich dazu
  for(var i=2;i<16;i++){shaker(t0+i*BT*0.5,0.35+i*0.015);}
  kick(t0+BAR,0.3);kick(t0+BAR*2,0.3);
  return 8;
}

// ===================================================
// SZENE 4: Meldi in Aktion (frÃ¶hlich, energetisch)
// ===================================================
function scene4(t0){
  // Volles Marimba-Groove
  var m=[C4,E4,G4,C5,A3,C4,E4,A4, F3,A3,C4,F4,G3,B3,D4,G4];
  m.forEach(function(n,i){marimba(n,t0+i*BT*0.55,0.6);});
  // FrÃ¶hliche FlÃ¶ten-Melodie
  flute(E5,t0+BT,BT*0.6,0.55);
  flute(G5,t0+BT*1.8,BT*0.5,0.55);
  flute(A5,t0+BT*2.5,BT*1.2,0.6);
  flute(G5,t0+BT*4,BT*0.5,0.5);
  flute(E5,t0+BT*4.8,BT*0.5,0.5);
  flute(D5,t0+BT*5.5,BT*1.5,0.55);
  // Zweite Phrase
  flute(C5,t0+BT*7.5,BT*0.5,0.5);
  flute(E5,t0+BT*8.2,BT*0.5,0.55);
  flute(G5,t0+BT*9,BT*2,0.6);
  // Volle Cello-Begleitung
  cello(C3,t0,BAR,0.6);
  cello(A2,t0+BAR,BAR,0.55);
  cello(F2,t0+BAR*2,BAR,0.55);
  cello(G2,t0+BAR*2+BAR,BAR,0.6);
  // Rhythmus: Shaker + Kicks auf 1 und 3
  for(var i=0;i<18;i++){shaker(t0+i*BT*0.5,0.4);}
  kick(t0,0.3);kick(t0+BAR,0.3);kick(t0+BAR*2,0.35);
  // Celesta-Highlights
  celesta(C5*2,t0+BT*2.5,0.25);
  celesta(G5,t0+BT*6,0.25);
  celesta(E5*2,t0+BT*9.5,0.3);
  return 9;
}

// ===================================================
// SZENE 5: Dashboard/Kommune (professionell, zuversichtlich)
// ===================================================
function scene5(t0){
  // Ruhiges Pad - Vertrauen
  pad(C3,t0,7.5,0.6);
  pad(G3,t0+0.5,7,0.45);
  pad(E3,t0+1,6.5,0.35);
  // Leise Marimba-Pulse
  [C3,G3,C4,E4,G3,C4,E4,G4,C4,E4,G4,C5].forEach(function(n,i){
    marimba(n,t0+i*BT*0.6,0.3);
  });
  // Zufriedene FlÃ¶te
  flute(G4,t0+BT*2,BT*1.8,0.45);
  flute(A4,t0+BT*4.5,BT*1.2,0.45);
  flute(G4,t0+BT*6.5,BT*2,0.5);
  flute(E4,t0+BT*9,BT*2.5,0.45);
  // Cello: stabil
  cello(C2,t0,BAR*1.5,0.5);
  cello(G2,t0+BAR*1.5,BAR*1.5,0.5);
  // Vereinzelte Celesta
  celesta(C5,t0+BT*3,0.2);
  celesta(E5,t0+BT*7,0.2);
  celesta(G5,t0+BT*10,0.2);
  return 8;
}

// ===================================================
// SZENE 6: Mission erfÃ¼llt! (triumphant, emotional)
// ===================================================
function scene6(t0){
  // GroÃŸer Auftakt: Harpe + Kick
  harp([C4,E4,G4,C5,E5,G5,C5*2],t0,0.1,0.6);
  kick(t0+0.1,0.5);
  // Volles Pad
  pad(C3,t0+0.5,7,0.7);
  pad(G3,t0+0.8,6.5,0.5);
  pad(E3,t0+1,6,0.4);
  // Triumphale FlÃ¶te (das Thema in voller Pracht)
  flute(C5,t0+BT*2,BT*0.6,0.6);
  flute(D5,t0+BT*2.8,BT*0.5,0.6);
  flute(E5,t0+BT*3.5,BT*0.6,0.65);
  flute(G5,t0+BT*4.3,BT*0.5,0.65);
  flute(A5,t0+BT*5,BT*2.5,0.7);
  // Sanft abfallend
  flute(G5,t0+BT*8,BT*0.8,0.55);
  flute(E5,t0+BT*9.2,BT*1,0.55);
  flute(C5,t0+BT*10.5,BT*3,0.6);
  // Volles Marimba
  var m=[C4,E4,G4,C5,G4,E4,C4,G3, C4,E4,G4,C5,E5,G4,C5,C4];
  m.forEach(function(n,i){marimba(n,t0+BT*1.5+i*BT*0.4,0.5);});
  // Starkes Cello
  cello(C3,t0,BAR*1.2,0.7);
  cello(G2,t0+BAR*1.2,BAR,0.65);
  cello(C3,t0+BAR*2.2,BAR*1.2,0.7);
  // Celesta-Regen
  celesta(C5*2,t0+BT*2,0.4);
  celesta(E5*2,t0+BT*5,0.4);
  celesta(G5*2,t0+BT*7,0.35);
  celesta(C5*2,t0+BT*10,0.3);
  // Rhythmus
  for(var i=0;i<16;i++){shaker(t0+BT+i*BT*0.45,0.4);}
  kick(t0+BT*2,0.35);kick(t0+BT*5,0.35);kick(t0+BT*8,0.3);
  return 8;
}

// ===================================================
// SZENE 7: CTA - Warmes Outro
// ===================================================
function scene7(t0){
  // Sanftes Pad ausklingend
  pad(C3,t0,9,0.55);
  pad(E3,t0+1,8,0.4);
  pad(G3,t0+1.5,7,0.3);
  // Letzte FlÃ¶ten-Phrase (das Thema, sanft)
  flute(E5,t0+BT*2,BT*2,0.4);
  flute(C5,t0+BT*5,BT*2.5,0.4);
  flute(G4,t0+BT*8,BT*3.5,0.35);
  // Harfe zum Abschluss
  harp([C4,E4,G4,C5],t0+BT*6,0.3,0.35);
  // Cello-Fundament
  cello(C2,t0,7,0.4);
  // Letzte Celesta
  celesta(C5*2,t0+BT*3,0.25);
  celesta(G5,t0+BT*7,0.2);
  return 10;
}

// === PLAYBACK ENGINE ===
var sceneFns=[scene0,scene1,scene2,scene3,scene4,scene5,scene6,scene7];

function musicLoop(){
  if(!mp)return;
  if(!ax||!mg)return;
  var t0=ax.currentTime+0.05;
  var s=curScene;
  var d=8;
  if(s>=0&&s<sceneFns.length){
    d=sceneFns[s](t0);
  }
  // Loop hÃ¤ufiger als die Szene lang ist â†’ Ãœberlappung, keine LÃ¼cken
  var loopIn=Math.min(d*0.65,5);
  lt=setTimeout(function(){if(mp)musicLoop();},Math.max(loopIn,2)*1000);
}

// Observe scene changes
(function(){
  setInterval(function(){
    var active=document.querySelector('.scene.active');
    if(active){
      var scenes=document.querySelectorAll('.scene');
      for(var i=0;i<scenes.length;i++){
        if(scenes[i]===active&&i!==curScene){
          curScene=i;break;
        }
      }
    }
  },250);
})();

function startM(){
  ini();var go=function(){
    mp=true;mg.gain.cancelScheduledValues(ax.currentTime);
    mg.gain.setValueAtTime(0.0001,ax.currentTime);
    mg.gain.linearRampToValueAtTime(0.9,ax.currentTime+1.5);
    musicLoop();updMUI();
  };
  if(ax.state==='suspended')ax.resume().then(go);else go();
}
function stopM(){
  mp=false;if(lt){clearTimeout(lt);lt=null;}
  if(mg&&ax){try{mg.gain.cancelScheduledValues(ax.currentTime);mg.gain.setValueAtTime(mg.gain.value,ax.currentTime);mg.gain.linearRampToValueAtTime(0.0001,ax.currentTime+1.5);}catch(e){}}
  updMUI();
}
window.toggleMusic=function(){if(mp)stopM();else startM();};
function updMUI(){
  var b=document.getElementById('musicBtn');if(!b)return;
  if(mp){b.textContent='ğŸ”Š';b.title='Musik aus';b.classList.add('mus-on');}
  else{b.textContent='ğŸµ';b.title='Musik an';b.classList.remove('mus-on');}
}
var ctrl=document.querySelector('.controls');
if(ctrl){var b=document.createElement('button');b.id='musicBtn';b.className='ctrl mus-btn';b.textContent='ğŸµ';b.title='Musik an';b.onclick=window.toggleMusic;ctrl.insertBefore(b,ctrl.firstChild);}
var ms=document.createElement('style');
ms.textContent='.mus-btn{transition:all .3s!important}.mus-btn.mus-on{background:rgba(126,224,160,.2)!important;box-shadow:0 0 8px rgba(126,224,160,.3)!important}';
document.head.appendChild(ms);
})();

// === ERZÃ„HLER: Stimme aus dem Off ===
// Hans-Paetsch-Style Narration per Web Speech API
(function(){
var synth=window.speechSynthesis;
if(!synth)return;

var narrationTexts=[
  // Szene 0: Titel (5s)
  "Dies ist die Geschichte von Meldi. Einem AuÃŸerirdischen mit groÃŸer Mission.",
  // Szene 1: Landung (8s)
  "Meldi gehÃ¶rt zu den Veloxanern. Ein Volk von Velofahrern, das allen Planeten Fahrradfreundlichkeit beibringt. Jetzt ist die Erde dran!",
  // Szene 2: Schock (9s)
  "Doch was Meldi hier vorfindet, ist alles andere als fahrradfreundlich. SchlaglÃ¶cher! Zugeparkte Radwege!",
  // Szene 3: Entdeckung (8s)
  "Da! Meldi entdeckt den Radwegemelder! Kein Account nÃ¶tig. Einfach Handy raus und melden!",
  // Szene 4: Meldi meldet (9s)
  "Meldi meldet fleiÃŸig! SchlaglÃ¶cher, WÃ¼nsche, und sogar eine fahrradfreundliche Einkehr. Die SaarlÃ¤nder lieben das!",
  // Szene 5: Dashboard (8s)
  "In der Kommune sind alle Meldungen auf einer Karte. Professionell aufbereitet fÃ¼r den Gemeinderat.",
  // Szene 6: Mission erfÃ¼llt (8s)
  "Mission erfÃ¼llt! Wenn BÃ¼rger melden, entstehen bessere Radwege.",
  // Szene 7: CTA
  "CTA_SPECIAL"
];

var narDelay=[400,300,200,200,300,300,300,600];
var lastNarScene=-1;
var currentUtterance=null;
var narEnabled=true;

function getGermanVoice(){
  var voices=synth.getVoices();
  // Prefer specific warm-sounding voices
  var preferred=['Anna','Markus','Hans','Petra','Google Deutsch','Daniel'];
  for(var p=0;p<preferred.length;p++){
    for(var v=0;v<voices.length;v++){
      if(voices[v].name.indexOf(preferred[p])>=0&&voices[v].lang.indexOf('de')>=0)return voices[v];
    }
  }
  // Fallback: any German voice
  for(var v=0;v<voices.length;v++){
    if(voices[v].lang.indexOf('de')>=0)return voices[v];
  }
  return null;
}

function speak(text,delay,opts){
  if(!narEnabled)return;
  // Cancel previous
  synth.cancel();
  setTimeout(function(){
    if(!narEnabled)return;
    var utt=new SpeechSynthesisUtterance(text);
    var voice=getGermanVoice();
    if(voice)utt.voice=voice;
    utt.lang='de-DE';
    utt.rate=(opts&&opts.rate)||1.0;
    utt.pitch=(opts&&opts.pitch)||0.92;
    utt.volume=(opts&&opts.volume)||1.0;
    currentUtterance=utt;
    synth.speak(utt);
  },delay||800);
}

function stopNarration(){
  synth.cancel();
  currentUtterance=null;
}

// Spezial-CTA: "Und jetzt..." [PAUSE] "...sind SIE dran!"
function speakCTA(delay){
  if(!narEnabled)return;
  synth.cancel();
  setTimeout(function(){
    if(!narEnabled)return;
    var voice=getGermanVoice();
    // Teil 1: "Und jetzt..."
    var u1=new SpeechSynthesisUtterance("Und jetzt");
    if(voice)u1.voice=voice;
    u1.lang='de-DE';u1.rate=0.9;u1.pitch=0.9;u1.volume=1.0;
    u1.onend=function(){
      // Dramatische Pause
      setTimeout(function(){
        if(!narEnabled)return;
        // Teil 2: "sind SIE dran!" - langsam, tief, deutlich
        var u2=new SpeechSynthesisUtterance("machen auch Sie mit!");
        if(voice)u2.voice=voice;
        u2.lang='de-DE';u2.rate=0.85;u2.pitch=0.95;u2.volume=1.0;
        synth.speak(u2);
      },1200);
    };
    synth.speak(u1);
  },delay||800);
}

// Beobachte Szenenwechsel
var narObserver=setInterval(function(){
  var active=document.querySelector('.scene.active');
  if(!active)return;
  var scenes=document.querySelectorAll('.scene');
  for(var i=0;i<scenes.length;i++){
    if(scenes[i]===active&&i!==lastNarScene){
      lastNarScene=i;
      if(i<narrationTexts.length){
        // Szene 7 (CTA): Zwei Teile mit dramatischer Pause
        if(i===7){
          speakCTA(narDelay[i]);
        } else {
          speak(narrationTexts[i],narDelay[i]);
        }
      }
      break;
    }
  }
},250);

// ErzÃ¤hler-Button in Controls
window.toggleNarrator=function(){
  narEnabled=!narEnabled;
  if(!narEnabled)stopNarration();
  var btn=document.getElementById('narBtn');
  if(btn){
    btn.textContent=narEnabled?'ğŸ™ï¸':'ğŸ”‡';
    btn.title=narEnabled?'ErzÃ¤hler aus':'ErzÃ¤hler an';
    btn.classList.toggle('nar-on',narEnabled);
  }
};

// Voices laden asynchron - beim Laden nochmal checken
if(synth.onvoiceschanged!==undefined){
  synth.onvoiceschanged=function(){getGermanVoice();};
}

// Button erstellen
var ctrl=document.querySelector('.controls');
if(ctrl){
  var nb=document.createElement('button');
  nb.id='narBtn';nb.className='ctrl nar-btn nar-on';
  nb.textContent='ğŸ™ï¸';nb.title='ErzÃ¤hler aus';
  nb.onclick=window.toggleNarrator;
  // Nach dem Musik-Button einfÃ¼gen
  var musicBtn=document.getElementById('musicBtn');
  if(musicBtn&&musicBtn.nextSibling)ctrl.insertBefore(nb,musicBtn.nextSibling);
  else ctrl.insertBefore(nb,ctrl.firstChild);
}
var ns=document.createElement('style');
ns.textContent='.nar-btn{transition:all .3s!important}.nar-btn.nar-on{background:rgba(255,200,60,.2)!important;box-shadow:0 0 8px rgba(255,200,60,.3)!important}';
document.head.appendChild(ns);

// Stop narration when film ends or is paused
var origTogglePlay=window.togglePlay||null;
// Narration stoppt bei Film-Ende
})();
</script>
<div class="share-toast" id="shareToast">ğŸ”— Link kopiert!</div>
</body>
</html>
